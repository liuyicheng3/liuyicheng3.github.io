<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta property="og:type" content="website">
<meta property="og:title" content="Nico随笔">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Nico随笔">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Nico随笔">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/"/>





  <title> Nico随笔 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Nico随笔</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/03/xml处理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liuycheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://github.com/liuyicheng3/learning-summary/blob/master/images/avatar.jpg?raw=true">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nico随笔">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/01/03/xml处理/" itemprop="url">
                  生成分享图片
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-03T00:00:00+08:00">
                2018-01-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="常用模块"><a href="#常用模块" class="headerlink" title="常用模块"></a>常用模块</h1><p>bs4  xml.dom.minidom  xml.etree   re</p>
<h1 id="1-bs4用法"><a href="#1-bs4用法" class="headerlink" title="1. bs4用法"></a>1. bs4用法</h1><p>详细使用文档 <a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/index.zh.html" target="_blank" rel="external">https://www.crummy.com/software/BeautifulSoup/bs4/doc/index.zh.html</a><br><a href="http://www.cnblogs.com/twinsclover/archive/2012/04/26/2471704.html" target="_blank" rel="external">http://www.cnblogs.com/twinsclover/archive/2012/04/26/2471704.html</a>  </p>
<pre><code>from bs4 import BeautifulSoup

soup = BeautifulSoup(content, &apos;xml&apos;)  
itemList= soup.select(&apos;html &gt; body &gt; div[class=&quot;area&quot;] &gt; ul.plist2.cf.ulList &gt; li &gt; a&apos;)  
itemList2= soup.select(&apos;div[id=&quot;newsList&quot;] &gt; ul[id=&quot;v2&quot;] &gt; li[class=&quot;item&quot;] &gt; a &apos;)   
</code></pre><p>判断书是否有属性的方法 tem.contents[0].attrs.has_key</p>
<pre><code>for item in itemList:
   if item.contents[0].attrs.has_key(&apos;src&apos;):
       avatar = item.contents[0][&apos;src&apos;]
   elif item.contents[0].attrs.has_key(&apos;lz_src&apos;):
       avatar = item.contents[0][&apos;lz_src&apos;]
   else:
       avatar=&apos;unset&apos;
       print item
   star = StarItem(item.text,avatar)
   currentPageStars.append(star)  
</code></pre><p>判断是否有子元素的方法 newsItemDiv.p<br>获取元素标签里面值的方法newsItemDiv.p.string</p>
<pre><code>for index,newsItemDiv in enumerate(itemList):
   tranItem = NewsItem(newsItemDiv.p.string if newsItemDiv.p else &quot;&quot;,newsItemDiv.img[&apos;data-src&apos;] if newsItemDiv.img else &quot;&quot;,proto+&quot;/&quot;+domain+newsItemDiv[&apos;href&apos;])
   newsItems.append(str(tranItem)+&quot;,\n&quot;)
</code></pre><p>ps:ul.plist2.cf.ulList 达标这个ul 使用了多种样式 plist2  cf  ulList     </p>
<h1 id="2-minidom"><a href="#2-minidom" class="headerlink" title="2. minidom"></a>2. minidom</h1><h2 id="使用minidom解析器打开-XML-文档"><a href="#使用minidom解析器打开-XML-文档" class="headerlink" title="使用minidom解析器打开 XML 文档"></a>使用minidom解析器打开 XML 文档</h2><pre><code>DOMTree = xml.dom.minidom.parse(xmlPath)
collection = DOMTree.documentElement
</code></pre><h2 id="在集合中获取所有colors"><a href="#在集合中获取所有colors" class="headerlink" title="在集合中获取所有colors"></a>在集合中获取所有colors</h2><pre><code>colors = collection.getElementsByTagName(&quot;color&quot;)

namelist = []
valuelist = []
</code></pre><h1 id="打印每部电影的详细信息"><a href="#打印每部电影的详细信息" class="headerlink" title="打印每部电影的详细信息"></a>打印每部电影的详细信息</h1><pre><code>for color in colors:
    if color.hasAttribute(&quot;name&quot;):
        colorname=color.getAttribute(&quot;name&quot;)
        colorvalue = color.childNodes[0].data
        if not (colorname in namelist):
            namelist.append(colorname)
            currentIndex = namelist.index(colorname) 
</code></pre><h1 id="3-etree"><a href="#3-etree" class="headerlink" title="3. etree"></a>3. etree</h1><pre><code>import xml.etree.ElementTree
tree = ElementTree.parse(lastYearPath )
allItems = tree.findall(&apos;data/item&apos;)
for pos,treeItem in enumerate(allItems):
    holidayYear = int(treeItem.attrib[&apos;year&apos;])
    holidayMonth = int(treeItem.attrib[&apos;month&apos;])
    holidayDate = int(treeItem.attrib[&apos;date&apos;])
</code></pre><h1 id="4-正则"><a href="#4-正则" class="headerlink" title="4. 正则"></a>4. 正则</h1><p> 对于xml里面的注释很难读取出来建议使用</p>
<pre><code>import re  
names = re.findall(r&quot;&lt;!\[CDATA\[(.*?)\]\]&quot;,data)
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/20/App核心指标/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liuycheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://github.com/liuyicheng3/learning-summary/blob/master/images/avatar.jpg?raw=true">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nico随笔">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/20/App核心指标/" itemprop="url">
                  App核心指标和广告计费方式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-20T00:00:00+08:00">
                2017-10-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="App核心指标"><a href="#App核心指标" class="headerlink" title="App核心指标"></a>App核心指标</h1><ol>
<li>pv     </li>
<li>uv     </li>
<li>ctr     </li>
<li><p>次日/7日留存/30日留存<br>一般目标是在40/20/10<br>参考文章：<a href="http://www.pmcaff.com/discuss/index/369885221299264?pmc_param=1" target="_blank" rel="external">http://www.pmcaff.com/discuss/index/369885221299264?pmc_param=1</a></p>
</li>
<li><p>dau  </p>
</li>
<li>mau</li>
<li>时长</li>
</ol>
<h1 id="广告计费方式："><a href="#广告计费方式：" class="headerlink" title="广告计费方式："></a>广告计费方式：</h1><ol>
<li>CPC</li>
</ol>
<p>按点击付费，原英文为Cost Per Click 每点击成本，网络广告每次点击的费用。是做为网络广告投放效果的重要参考数据。CPC是网络广告界一种常见的定价形式。例如，关键词广告等依据效果付费的广告形式，一般采用这种定价模式。</p>
<ol>
<li>CPM</li>
</ol>
<p>按千次展示付费，其原始英文为Cost Per Mille，简称CPM。现在也有人将其译成cost per one thousand impressions 或cost per thousand。前者中文名为每千人印象成本。后者称谓相同，但简称为CPT。所指内涵与CPM相同。其计算公式为：<br>千人成本=（广告费用/到达人数）×1000。</p>
<ol>
<li>CPA</li>
</ol>
<p>按行为付费，其原始英文为 Cost Per Activity(Action)，每次动作成本，即根据每个访问者对网络广告所采取的行动收费的定价模式。对于用户行动有特别的定义，包括形成一次交易、获得一个注册用户、或者对网络广告的一次点击等。</p>
<ol>
<li>CPD</li>
</ol>
<p>按天收费，其原始英文为 Cost per day是广告合作的一种常见方式，相比当前比较流行的CPS（按销售付费 Cost per sales），优势在于对合作的基础条件没有过高要求，容易促成双方合作；劣势在于其在长期合作中，不如CPS形式实时有效。</p>
<ol>
<li>CPS</li>
</ol>
<p>按实际销售产品的提成来换算广告刊登金额，其原始英文为Cost Per Sales，CPS广告同CPA广告一样广告主为规避广告费用风险，按照广告点击之后产生的实际销售的提成付给广告站点销售提成费用。</p>
<ol>
<li>dCPM</li>
</ol>
<p>DSP普遍采用dCPM作为结算体系，dCPM指的是dynamic CPM，与目前网络广告市场长讲的CPM方式（此CPM相应的成为flat CPM）区别。dCPM基于RTB技术诞生，指的是每一次的impression出价是变化的。其每次出价均依据广告主广告投放的效果(一般是CPS）来实时计算，以得出对广告主最有利的价格，从而保证了广告主的利益。同时又因为以impression与媒体结算，也确保了媒体的收益。</p>
<p><a href="https://www.umeng.com/reports.html" target="_blank" rel="external">https://www.umeng.com/reports.html</a><br>中国移动互联网发展报告 会有说明行业普遍的留存情况</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/10/点赞爱心动画/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liuycheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://github.com/liuyicheng3/learning-summary/blob/master/images/avatar.jpg?raw=true">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nico随笔">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/10/点赞爱心动画/" itemprop="url">
                  点赞爱心动画
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-10T00:00:00+08:00">
                2017-10-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h1><p> 实现直播房间点赞爱心动画（不是送礼物的动画）<br> 难点：流畅的飘爱心</p>
<h1 id="1-方案1"><a href="#1-方案1" class="headerlink" title="1. 方案1"></a>1. 方案1</h1><p>直接使用animator做动画<br>参考资料： <a href="https://github.com/Yasic/QQBubbleView" target="_blank" rel="external">https://github.com/Yasic/QQBubbleView</a>  </p>
<h3 id="1-1-优化方向："><a href="#1-1-优化方向：" class="headerlink" title="1.1. 优化方向："></a>1.1. 优化方向：</h3><ol>
<li>削峰</li>
<li>不要每次都inflate layout，尝试模拟listview的recycleBin 对用跑完动画的View 重新赋值初始化</li>
</ol>
<h2 id="2-方案2："><a href="#2-方案2：" class="headerlink" title="2. 方案2："></a>2. 方案2：</h2><p>直接在View上绘制爱心<br>参考资料：<a href="https://github.com/HomHomLin/Android-DivergeView" target="_blank" rel="external">https://github.com/HomHomLin/Android-DivergeView</a><br>核心就是一个while循环，不断计算当前爱心的位置</p>
<pre><code>while (mRunning) {
    if (mQueen == null) {
        continue;
    }
    if (mIsDrawing) {
        //如果正在绘制，不要处理数据
        continue;
    }
    dealQueen();
    dealDiverge();
    mIsDrawing = true;
    postInvalidate();
}
</code></pre><p>在dealQueen里面处理正在等待走动画的点赞  </p>
<pre><code>if (mQueen.size() &gt; 0 &amp;&amp; now - mLastAddTime &gt; mQueenDuration) {
        mLastAddTime = System.currentTimeMillis();
        DivergeInfo divergeInfo = null;
        if (mDeadPool.size() &gt; 0) {
            //死池里面有空闲的divergeNode
            divergeInfo = mDeadPool.get(0);
            mDeadPool.remove(0);
        }
        if (divergeInfo == null) {
            divergeInfo = createDivergeNode(mQueen.get(0));
        }
        divergeInfo.reset();
        divergeInfo.mType = mQueen.get(0);
        mDivergeInfos.add(divergeInfo);
        mQueen.remove(0);
    }
</code></pre><p>在dealDiverge里面计算已经在走动画的爱心的位置  </p>
<pre><code>for (int i = 0; i &lt; mDivergeInfos.size(); i++) {
       DivergeInfo divergeInfo = mDivergeInfos.get(i);
       float timeLeft = 1.0F - divergeInfo.mDuration;
       divergeInfo.mDuration += mDuration;
       float x, y;
       //二次贝塞尔
       float time1 = timeLeft * timeLeft;
       float time2 = 2 * timeLeft * divergeInfo.mDuration;
       float time3 = divergeInfo.mDuration * divergeInfo.mDuration;
       x = time1 * (mPtStart.x)
               + time2 * (divergeInfo.mBreakPoint.x)
               + time3 * (divergeInfo.mEndPoint.x);

       divergeInfo.mX = x;

       y = time1 * (mPtStart.y)
               + time2 * (divergeInfo.mBreakPoint.y)
               + time3 * (divergeInfo.mEndPoint.y);

       divergeInfo.mY = y;

       if (divergeInfo.mY &lt;= divergeInfo.mEndPoint.y) {
           mDivergeInfos.remove(i);
           mDeadPool.add(divergeInfo);
           i--;
           continue;
       }
   }
</code></pre><p>onDraw方法</p>
<pre><code>for (DivergeInfo divergeInfo : mDivergeInfos) {
          mPaint.setAlpha((int) (255 * divergeInfo.mY / mPtStart.y));
          Bitmap bm = mDivergeViewProvider.getBitmap(divergeInfo.mType);
          float originCenterX = divergeInfo.mX + bm.getWidth() / 2;
          float originCenterY = divergeInfo.mY + bm.getHeight() / 2;
          float scaleWidth, scaleHeight;               
          scaleWidth = bm.getWidth();
          scaleHeight = bm.getHeight();
          RectF destRect = new RectF(originCenterX - scaleWidth / 2, originCenterY - scaleHeight / 2,
                  originCenterX + scaleWidth / 2, originCenterY + scaleHeight / 2);
          canvas.drawBitmap(bm, null
                  , destRect,
                  mPaint);
      }
 mIsDrawing = false;
</code></pre><p>ps：映客的点赞爱心就是这么实现的（映客是本地点赞出爱心，这个直接分析元素会失败，可以进入直播后，断网然后分析元素）</p>
<h3 id="2-1-优化方向："><a href="#2-1-优化方向：" class="headerlink" title="2.1. 优化方向："></a>2.1. 优化方向：</h3><ol>
<li>停止爱心动画的时机（什么时候可以停止while循环）</li>
<li>削峰：Android 每隔 16.6 ms 刷新一次屏幕，可以根据这个计算一次主流机型阈值</li>
</ol>
<p>都需要利用到削峰</p>
<h1 id="额外知识点"><a href="#额外知识点" class="headerlink" title="额外知识点"></a>额外知识点</h1><p>二阶贝塞尔曲线公式：<br><img src="https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D317/sign=9aefef4b08f79052eb1f413f3bf2d738/11385343fbf2b21129581916cb8065380cd78e70.jpg" alt="二阶">    </p>
<p>三阶贝塞尔曲线公式：<br><img src="https://gss0.bdstatic.com/-4o3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D421/sign=9a6521eab8014a90853e47bf98763971/f603918fa0ec08fad54f8dff58ee3d6d55fbda1f.jpg" alt="三阶">    </p>
<p>在线演示：<a href="http://myst729.github.io/bezier-curve/" target="_blank" rel="external">http://myst729.github.io/bezier-curve/</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/15/全屏模式adjustadjustResize/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liuycheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://github.com/liuyicheng3/learning-summary/blob/master/images/avatar.jpg?raw=true">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nico随笔">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/15/全屏模式adjustadjustResize/" itemprop="url">
                  全屏模式AdjustResize实现
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-15T00:00:00+08:00">
                2017-09-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="方案1"><a href="#方案1" class="headerlink" title="方案1"></a>方案1</h2><p>使用stackoverflo 上的 AndroidBug5497Workaround</p>
<p>但是这个AndroidBug5497Workaround有个问题就是<br>A如果是最开始输入框在下面，就会出现输入法先把界面顶上去 ，然后又调整下来的过程<br>B如果在最上面就不会出现这个过程  </p>
<p>这个我们先考虑没有使用AndroidBug5497Workaround时候的情况<br>A如果是最开始输入框在下面，就会出现输入法会把整个界面顶上去<br>B如果在最上面，整个界面会看着基本不动，但是root view没有adjustResize的过程，因此导致原来alignparentBottom的元素看不到  </p>
<p>AndroidBug5497Workaround的原理是监听rootView 可视区域的变化，但是这个onGlobalLayout回调的速度明显慢于键盘弹出的速度，<br>所以在A情况下就会出现顶上去又弹回去的情况<br>（如果在这里纠结使监听可视区域变化速度 和 键盘弹出速度  完全 一直的话 ，那是不可能的）<br>而在B情况下，由于没加AndroidBug5497Workaround这个时候本身就不会有顶去来的过程，所以主体界面本身就不会有抖动情况（注意 我们监听时候改变了主体界面的高度，但是这个根本不会影响到主体界面，因为即使改变高度， android 绘制的坐标系也是从左上角开始的，所以不存在任何问题）<br>而这时候我们改变root view的size  只是会导致底部的aliparentBottom的控件上移动，上移动的速度实际上比键盘弹出的速度慢，但是最终能调整到键盘的位置，所以这里根本不会导致主题界面抖动</p>
<pre><code>mChildOfContent.getViewTreeObserver().addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener() {
          public void onGlobalLayout() {
              possiblyResizeChildOfContent();
          }
      });

private void possiblyResizeChildOfContent() {
      int usableHeightNow = computeUsableHeight();
      if (usableHeightNow != usableHeightPrevious) {
          int usableHeightSansKeyboard = mChildOfContent.getRootView().getHeight();
          int heightDifference = usableHeightSansKeyboard - usableHeightNow;
          if (heightDifference &gt; (usableHeightSansKeyboard/4)) {
              // keyboard probably just became visible
              frameLayoutParams.height = usableHeightSansKeyboard - heightDifference;
          } else {
              // keyboard probably just became hidden
              frameLayoutParams.height = usableHeightSansKeyboard;
          }
          mChildOfContent.requestLayout();
          usableHeightPrevious = usableHeightNow;
      }
  }

private int computeUsableHeight() {
    Rect r = new Rect();
    mChildOfContent.getWindowVisibleDisplayFrame(r);
    return (r.bottom - r.top);
}
</code></pre><h4 id="虚拟按键"><a href="#虚拟按键" class="headerlink" title="虚拟按键"></a>虚拟按键</h4><p>注意android的虚拟按键有两种：<br>一种是N5 N6一类的固定在底部的虚拟按键  </p>
<p>一种是华为 小米mix 一类的的  可以通过手势动态控制底部虚拟按键显示还隐藏<br>这种就需要动态计算高度  </p>
<p>为了解决A问题，需要在顶部放置一个fake EditText ，点击目标EditText时候先让顶部的fakeEditText获得焦点，待键盘完全弹出来后再把焦点转移给目标EditText<br>具体方案：目标EditText监控ontouch事件，在TouchUp时候消耗掉这个事件，这样就不会触发键盘直接弹出来了，这时候，顶部的 fake EditText先获取焦点，延迟一段时间 待键盘完全弹出后再让目标EditText获取焦点</p>
<h2 id="方案2："><a href="#方案2：" class="headerlink" title="方案2："></a>方案2：</h2><p><a href="https://github.com/Jacksgong/JKeyboardPanelSwitch" target="_blank" rel="external">https://github.com/Jacksgong/JKeyboardPanelSwitch</a><br>原理：<br>在目标EditText下面加一个KPSwitchPanelLinearLayout  通过动态设置这个KPSwitchPanelLinearLayout的Visual状态和高度动态调整高度<br>其包括两个步骤<br>1、测量和调整高度<br>2、editText获取焦点事件的拦截（也是通过ontouch实现的）  </p>
<pre><code>cn.dreamtobe.kpswitch.util.KeyboardUtil#attach(android.app.Activity, cn.dreamtobe.kpswitch.IPanelHeightTarget,    cn.dreamtobe.kpswitch.util.KeyboardUtil.OnKeyboardShowingListener)  
</code></pre><p>这里实际上是加了个  </p>
<pre><code>contentView.getViewTreeObserver().
                addOnGlobalLayoutListener(
                        new KeyboardStatusListener(isFullScreen, isTranslucentStatus,
                                isFitSystemWindows,
                                contentView, target, listener));  
</code></pre><p>在onGlobalLayout里面计算出合适的高度设置给pannelView</p>
<pre><code>userRootView.getWindowVisibleDisplayFrame(r);
            displayHeight = (r.bottom - r.top);
......              
calculateKeyboardHeight(displayHeight);
calculateKeyboardShowing(displayHeight);

中 calculateKeyboardHeight

panelHeightTarget.refreshHeight
</code></pre><p>这里涉及到一个问题就是初始时候不止到键盘高度怎么办(或者手动调整过键盘高度怎么办)<br>初始高度：会设置一个默认的最小高度给panel，然后待键盘完全弹出后在修复这个高度  </p>
<pre><code>panelLayoutHandler.resetToRecommendPanelHeight(panelHeight)
&gt;&gt;
ViewUtil.refreshHeight(panelLayout, recommendPanelHeight);
......
final int validPanelHeight = KeyboardUtil.getValidPanelHeight(view.getContext());
ViewGroup.LayoutParams layoutParams = view.getLayoutParams();
if (layoutParams == null) {
    layoutParams = new ViewGroup.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT,
            validPanelHeight);
    view.setLayoutParams(layoutParams);
} else {
    layoutParams.height = validPanelHeight;
    view.requestLayout();
}
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/10/android全屏模键盘冲突/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liuycheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://github.com/liuyicheng3/learning-summary/blob/master/images/avatar.jpg?raw=true">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nico随笔">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/10/android全屏模键盘冲突/" itemprop="url">
                  全屏模式底部键盘冲突
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-10T00:00:00+08:00">
                2017-09-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="场景：全屏模式下activity的adjustResize-失效-弹键盘时候底部的输入框无法自动调整到键盘区域的上方"><a href="#场景：全屏模式下activity的adjustResize-失效-弹键盘时候底部的输入框无法自动调整到键盘区域的上方" class="headerlink" title="场景：全屏模式下activity的adjustResize 失效,弹键盘时候底部的输入框无法自动调整到键盘区域的上方"></a>场景：全屏模式下activity的adjustResize 失效,弹键盘时候底部的输入框无法自动调整到键盘区域的上方</h1><h2 id="1-方案一："><a href="#1-方案一：" class="headerlink" title="1. 方案一："></a>1. 方案一：</h2><p>使用 AndroidBug5497Workaround （<a href="https://stackoverflow.com/questions/7417123/android-how-to-adjust-layout-in-full-screen-mode-when-softkeyboard-is-visible）" target="_blank" rel="external">https://stackoverflow.com/questions/7417123/android-how-to-adjust-layout-in-full-screen-mode-when-softkeyboard-is-visible）</a>  </p>
<p><img src="https://github.com/liuyicheng3/learning-summary/blob/master/images/planA_normal.gif?raw=true" height="200px" width="100px">  </p>
<p>原理：通过 getViewTreeObserver().addOnGlobalLayoutListener监听当前屏幕显示区域的大小，然后动态调整Activity rootView的height，实现“adjust resize”的效果   </p>
<pre><code> Rect r = new Rect();
 mChildOfContent.getWindowVisibleDisplayFrame(r);
int usableHeightNow = r.bottom - r.top;
  if (usableHeightNow != usableHeightPrevious) {
      int usableHeightSansKeyboard = mChildOfContent.getRootView().getHeight();
      int heightDifference = usableHeightSansKeyboard - usableHeightNow;
      if (heightDifference &gt; (usableHeightSansKeyboard/4)) {
          // keyboard probably just became visible
          frameLayoutParams.height = usableHeightSansKeyboard - heightDifference;
      } else {
          // keyboard probably just became hidden
          frameLayoutParams.height = usableHeightSansKeyboard;
      }
      mChildOfContent.requestLayout();
      usableHeightPrevious = usableHeightNow;
</code></pre><p>但是这个不能完全解决我们问题，会遇到下面的问题：<br>在输入框在屏幕区域上方是没问题，在输入框在底部时候，会有一个特别不好的现象，键盘弹出后会迅速把整个Activity完全顶上去，然后调整回来。  </p>
<p><img src="https://github.com/liuyicheng3/learning-summary/blob/master/images/planA.gif?raw=true" height="200px" width="100px"></p>
<p>问题的原因是是OnGlobalLayoutListener不是实时和键盘弹时屏幕显示区域同步的。所以就会在键盘弹起的瞬间先把整个activity顶上去，然后顶上去后，屏幕内容又会掉下来  </p>
<p>补丁方案：<br>输入框在底部时候不要直接弹出键盘，先让顶部的一个1px的输入框获得这个这个焦点，待键盘完全弹出来后再把焦点传递给底部的这个输入框，这样就不会有顶整个界面起来的现象</p>
<p><img src="https://github.com/liuyicheng3/learning-summary/blob/master/images/planA_fix.gif?raw=true" height="200px" width="100px"></p>
<p>补充问题<br>为什么在顶部的时候不会出现顶上去又下来的情况？<br>因为 输入框在最上面，键盘输入法只要弹出时不盖住输入框，就不会顶起这个Activity的内容，而内容区域调整也是延迟于键盘弹起速度的，但是由于键盘盖住了所以视觉感觉不出来    </p>
<h2 id="2-方案二"><a href="#2-方案二" class="headerlink" title="2.方案二"></a>2.方案二</h2><p>JkeyboardSwitch （<a href="https://github.com/Jacksgong/JKeyboardPanelSwitch）" target="_blank" rel="external">https://github.com/Jacksgong/JKeyboardPanelSwitch）</a>  </p>
<p>原理是在输入框下面加了一个和键盘高度相同的panel，在键盘弹出来的瞬间panel显示出来（invisualble状态），这样键盘的弹出和隐藏与panel的的invisualble和gone的状态同步起来，看起来的效果就是键盘出来时候把输入框顶上去，键盘收起来时候把输入框收回去  </p>
<p>这个方案的一个问题是“怎么在第一次弹出时候初始化panel高度和键盘高度一致?”    </p>
<p><img src="https://github.com/liuyicheng3/learning-summary/blob/master/images/planB.gif?raw=true" height="200px" width="100px"></p>
<p>补丁方案：<br>第一次弹出瞬间把输入框的区域设置为Invisualbel ，初始panel的高度尽量大，待键盘完全弹出后把输入框区域显示出来，然后调整panel的高度，这样就能在用户无察觉的情况初始化这个panel高度。   </p>
<p><img src="https://github.com/liuyicheng3/learning-summary/blob/master/images/planB_fix.gif?raw=true" height="200px" width="100px"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/03/AMS浅析_02/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liuycheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://github.com/liuyicheng3/learning-summary/blob/master/images/avatar.jpg?raw=true">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nico随笔">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/08/03/AMS浅析_02/" itemprop="url">
                  AMS server端分析
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-03T00:00:00+08:00">
                2017-08-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Ams-server端"><a href="#Ams-server端" class="headerlink" title="Ams  server端"></a>Ams  server端</h1><h2 id="核心类："><a href="#核心类：" class="headerlink" title="核心类："></a>核心类：</h2><p>ActivityManagerNative是从Client接受binder 消息<br>ApplicationThreadNative 是从AMS向Client发送指令<br>ActivityStackSupervisor<br>ActivityStack就是存储ActivityRecord的容器，主要操作都是通过ActivityStackSupervisor来做的</p>
<p>ps:注意接IApplicationThread   </p>
<pre><code>A. ApplicationThreadNative实现了一部分，ActivityMangerService继承ApplicationThreadNative,然后实现了剩余的    
B. ApplicationThreadNative.ApplicationThreadProxy完全实现了IApplicationThread
</code></pre><h2 id="Activity-A启动Activity-B流程"><a href="#Activity-A启动Activity-B流程" class="headerlink" title="Activity A启动Activity B流程"></a>Activity A启动Activity B流程</h2><h2 id="1-Activity-A启动Activity-B流程"><a href="#1-Activity-A启动Activity-B流程" class="headerlink" title="1. Activity A启动Activity B流程"></a>1. Activity A启动Activity B流程</h2><p>ActivityManagerNative#onTransact（）&gt;&gt;<br>ActivityManagerService#startActivity()&gt;&gt;<br>ActivityManagerService#startActivityAsUser()&gt;&gt;<br>ActivityStackSupervisor#startActivityMayWait()&gt;&gt;<br>ActivityStack#resumeTopActivityLocked（）&gt;&gt;<br>ActivityStack#startPausingLocked（）&gt;&gt;<br>pause上一个Activity的调用方法</p>
<pre><code>prev.app.thread.schedulePauseActivity(prev.appToken, prev.finishing,  userLeaving, prev.configChangeFlags);
</code></pre><p>ActivityMangerNative.ApplicationThreadProxy.schedulePauseActivity  &gt;&gt;<br>）</p>
<p>等client pause完了后<br>ActivityManagerNative#activityPaused（）<br>这里实际调用的是ActivityManagerService的activityPaused（）&gt;&gt;<br>ActivityStack#completePauseLocked() &gt;&gt;<br>ActivityStack#resumeTopActivityLocked（）&gt;&gt;<br>ActivityStackSupervisor#resumeTopActivitiesLocked(topStack, prev, null);  </p>
<p>这时候有两部分，如果当前应用还没有启动就通过Process  </p>
<pre><code>    if (app != null &amp;&amp; app.thread != null) {
        try {
            app.addPackage(r.info.packageName, mService.mProcessStats);
            realStartActivityLocked(r, app, andResume, checkConfig);
            return;
        } catch (RemoteException e) {
            Slog.w(TAG, &quot;Exception when starting activity &quot;
                    + r.intent.getComponent().flattenToShortString(), e);
        }

        // If a dead object exception was thrown -- fall through to
        // restart the application.
    }

    mService.startProcessLocked(r.processName, r.info.applicationInfo, true, 0,
            &quot;activity&quot;, r.intent.getComponent(), false, false, true);
}
</code></pre><h3 id="1-1-在已有进程中启动"><a href="#1-1-在已有进程中启动" class="headerlink" title="1.1 在已有进程中启动"></a>1.1 在已有进程中启动</h3><p>ActivityStackSupervisor#realStartActivityLocked（）&gt;&gt;  </p>
<pre><code>app.thread.scheduleLaunchActivity(new Intent(r.intent), r.appToken,
System.identityHashCode(r), r.info,
new Configuration(mService.mConfiguration), r.compat,
app.repProcState, r.icicle, results, newIntents, !andResume,
mService.isNextTransitionForward(), profileFile, profileFd,profileAutoStop;  
</code></pre><p>ActivityMangerNative.ApplicationThreadProxy.scheduleLaunchActivity  &gt;&gt;  </p>
<h3 id="1-2-App进程不存在，需要新建"><a href="#1-2-App进程不存在，需要新建" class="headerlink" title="1.2 App进程不存在，需要新建"></a>1.2 App进程不存在，需要新建</h3><p>ActivityManagerService#startProcessLocked()&gt;&gt;      </p>
<h4 id="1-2-1-fork一个新的进程的三个步骤："><a href="#1-2-1-fork一个新的进程的三个步骤：" class="headerlink" title="1.2.1 fork一个新的进程的三个步骤："></a>1.2.1 fork一个新的进程的三个步骤：</h4><p>①AMS通过Socket通信，向Zygote发送一个创建进程请求，Zygote创建新进程。<br>②创建好进程后，调用ActivityThread.main()。到此，我们到了新了一个进程中，也是程序的入口出。<br>③调用ActivityThread.attach()开始新的应用程序，接着同过Binder通信通知AMS，新的进程已经创建好了，可以开始新的程序了。  </p>
<h4 id="1-2-2-ActivityManagerNative-attachApplication"><a href="#1-2-2-ActivityManagerNative-attachApplication" class="headerlink" title="1.2.2  ActivityManagerNative.attachApplication()"></a>1.2.2  ActivityManagerNative.attachApplication()</h4><p>ps：实际调用的是ActivityManagerService.attachApplication<br>①根据Binder.getCallingPid(),或得客户进程pid，并调用attachApplicationLocked(IApplicationThreadthread,int pid)<br>②在attachApplicationLocked中，根据pid找到对应的ProcessRecord对象，如果找不到说明改pid客户进程是一个没经过AMS允许的进程。<br>③为ProcessRecordapp对象内部变量赋值<br>④确保目标程序（APK）文件已经被转换为了odex文件。Android中安装程序是APK文件，实际上是一个zip文件。<br>⑤调用ActivityStack.realStartActivityLocked通知客户进程运行指定Activity.<br>⑥调用ApplicationThread.scheduleLaunchActivity，启动指定Activity。  </p>
<h4 id="1-2-3-客户进程启动指定Activity"><a href="#1-2-3-客户进程启动指定Activity" class="headerlink" title="1.2.3 客户进程启动指定Activity"></a>1.2.3 客户进程启动指定Activity</h4><p>AMS通过IPC通行，通知客户进程启动指定Activity：<br>①调用ApplicationThread.scheduleLaunchActivity<br>②经过Handler消息传动，调用ActivityThread.handleLaunchActivity()<br>③调用ActivityThread.performLaunchActivity()完成Activity的加载，并最终调用Activity生命周期的onCreate()方法<br>④performLaunchActivity返回，继续调用ActivityThread.handleResumeActivity(),该方法内部又调用ActivityThread.performResumeActivity(),其内部仅仅调用了目标Activity的onResume()方法。到此Activity启动完成。<br>⑤添加一个IdleHandler对象，因为在一般情况下，该步骤执行完毕后，Activity就会进入空闲状态，所以就可以进行内存回收。  </p>
<h2 id="2-ActivityStack-、TaskRecord和ActivityRecord"><a href="#2-ActivityStack-、TaskRecord和ActivityRecord" class="headerlink" title="2. ActivityStack 、TaskRecord和ActivityRecord"></a>2. ActivityStack 、TaskRecord和ActivityRecord</h2><p>从ActivityStack#destroyActivityLocked（）&gt;&gt;     </p>
<p>ActivityStack#removeActivityFromHistoryLocked（）&gt;&gt;  </p>
<pre><code>final TaskRecord task = r.task;
if (task != null &amp;&amp; task.removeActivity(r)) {
    if (DEBUG_STACK) Slog.i(TAG,
             &quot;removeActivityFromHistoryLocked: last activity removed from &quot; + this);
     if (mStackSupervisor.isFrontStack(this) &amp;&amp; task == topTask() &amp;&amp; task.mOnTopOfHome) {
          mStackSupervisor.moveHomeToTop();
      }
       mStackSupervisor.removeTask(task);
  }
 r.takeFromHistory()
</code></pre><p>这里正式开始处理TaskRecord栈里面Activity记录</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/01/AMS浅析_01/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liuycheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://github.com/liuyicheng3/learning-summary/blob/master/images/avatar.jpg?raw=true">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nico随笔">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/08/01/AMS浅析_01/" itemprop="url">
                  AMS client端分析
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-01T00:00:00+08:00">
                2017-08-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Activity启动理解"><a href="#Activity启动理解" class="headerlink" title="Activity启动理解"></a>Activity启动理解</h1><p>PS：<br>一定要下载官方对应版本SDK，然后应用的SDK版本也要对应<br>建议配合GrepCode 查找类的位置，</p>
<h1 id="1-Android的CS模式"><a href="#1-Android的CS模式" class="headerlink" title="1. Android的CS模式"></a>1. Android的CS模式</h1><p>Android启动是通过AtivityThread的main函数启动的，<br>四大组件的生命周期都是通过AMS远程控制的，比如我们启动一个Acitivity,Service等都不是直接启动的，都是binder告诉AMS我们要启动四大组件，然后AMS通过binder处理（比如Activity A要启动Activity B，但是中途涉及到A的onpause  onStop和B 的oncreate，都是AMS依据ActivityRecord进行处理的）</p>
<h1 id="2-三个核心部分"><a href="#2-三个核心部分" class="headerlink" title="2. 三个核心部分"></a>2. 三个核心部分</h1><h2 id="client端："><a href="#client端：" class="headerlink" title="client端："></a>client端：</h2><p>ActivityThread<br>ActivityMangerNative   和ActivityManagerProxy<br>ApplicationThread和ApplicationThreadNative  </p>
<p>其实还涉及到：其它的比如 Instrumentation但是这个不是核心类</p>
<h2 id="Server端"><a href="#Server端" class="headerlink" title="Server端"></a>Server端</h2><p>ApplicationThreadProxy<br>ActivityMangerService<br>ProcessRecord<br>ActivityStack<br>ActivityRecord  </p>
<h2 id="跨进程通讯Binder"><a href="#跨进程通讯Binder" class="headerlink" title="跨进程通讯Binder"></a>跨进程通讯Binder</h2><p>Binder 和 Parcel</p>
<h1 id="3-Activity-A-启动Activity-B的流程详解"><a href="#3-Activity-A-启动Activity-B的流程详解" class="headerlink" title="3. Activity A 启动Activity B的流程详解"></a>3. Activity A 启动Activity B的流程详解</h1><p>ps：<br>ActivityMangerNative是往AMS发送消息的<br>ApplicationThread是从AMS接受指令消息的</p>
<h2 id="1、Client发送Intent"><a href="#1、Client发送Intent" class="headerlink" title="1、Client发送Intent"></a>1、Client发送Intent</h2><p>Activity#startActivity(Intent) &gt;&gt; Instrumentation#execStartActivity()  &gt;&gt;<br>ActivityManagerNative#startActivity() &gt;&gt;</p>
<h2 id="2、AMS-查询栈，告诉要Pause"><a href="#2、AMS-查询栈，告诉要Pause" class="headerlink" title="2、AMS 查询栈，告诉要Pause"></a>2、AMS 查询栈，告诉要Pause</h2><p>ActivityMangerNative#onTransact() &gt;&gt;    </p>
<p>ActivityMangerNative#schedulePauseActivity()这里是抽象的具体实现在<br>ActivityThread$ApplicationThread#schedulePauseActivity() &gt;&gt;   </p>
<p>ActivityThread#sendMessage() 也就是通过H mH 发送Message&gt;&gt;<br>ActivityThread$H#handleMessage()&gt;&gt;<br>ActivityThread#handlePauseActivity这里先要取出当前Activity ActivityClientRecord r = mActivities.get(token) &gt;&gt;<br>ActivityThread#performPauseActivity()&gt;&gt;    </p>
<p>Instrumentation#callActivityOnPause &gt;&gt;</p>
<p> ActivityManagerNative#activityPaused(token) 这个是在上一步Instrumentation pause完Activity后顺序执行的<br> 这里也就是通过binder发送消息&gt;&gt;  </p>
<p> PS:Activity切换要不要调用onstop 要看Theme，如果是android:style/Theme.Translucent就不会调用Onstop。所以我是不讲stop这个流程（实际上鄙人是有点懒。。。）</p>
<h2 id="3、AMS正式启动-Activity-B"><a href="#3、AMS正式启动-Activity-B" class="headerlink" title="3、AMS正式启动 Activity B"></a>3、AMS正式启动 Activity B</h2><p> ActivityMangerNative#onTransact() &gt;&gt;    </p>
<p>ActivityMangerNative#scheduleLaunchActivity()这里是抽象的具体实现在<br>ActivityThread$ApplicationThread#scheduleLaunchActivity() &gt;&gt;  </p>
<p>经过H mH转到主线程里面<br>ActivityThread#handleLaunchActivity&gt;&gt; </p>
<p>ActivityThread#performLaunchActivity<br>初始化Activity包括以下几步  </p>
<ol>
<li><p>生成Activity B ，这里仅仅是生成简单的java类 </p>
<pre><code>java.lang.ClassLoader cl = r.packageInfo.getClassLoader();
         activity = mInstrumentation.newActivity(
                 cl, component.getClassName(), r.intent);  
</code></pre></li>
<li><p>附加给Activity 各种Android系统类型</p>
<pre><code>attach(Context context, ActivityThread aThread,
    Instrumentation instr, IBinder token, int ident,
    Application application, Intent intent, ActivityInfo info,
    CharSequence title, Activity parent, String id,
    NonConfigurationInstances lastNonConfigurationInstances,
    Configuration config, String referrer, IVoiceInteractor voiceInteractor) 
</code></pre></li>
<li><p>回调oncreate  注意这个地方不会通知AMS</p>
<pre><code>mInstrumentation.callActivityOnCreate(activity, r.state);  
</code></pre></li>
</ol>
<p>最终这个会调用到Activity的oncreate</p>
<p>ps：ActivityThread.H 的Message可以看看，就可以知道有哪些操作需要和AMS打交道 </p>
<blockquote>
<blockquote>
</blockquote>
</blockquote>
<p>ActivityThread#handleResumeActivity<br>这里会依次调用</p>
<ol>
<li>ActivityThread#performResumeActivity(token, clearHide)   </li>
<li>ActivityManagerNative#willActivityBeVisible（）<br>告诉AMS Activity已经准备好了   </li>
<li>ActivityManagerNative#activityResumed（）<br>告诉AMS Activity已经resumed</li>
</ol>
<p>在2、3步骤里面就是做Activity B的界面绘制工作:</p>
<pre><code>r.window = r.activity.getWindow();
View decor = r.window.getDecorView();
decor.setVisibility(View.INVISIBLE);
ViewManager wm = a.getWindowManager();
a.mDecor = decor;
l.type = WindowManager.LayoutParams.TYPE_BASE_APPLICATION;
l.softInputMode |= forwardBit;
if (a.mVisibleFromClient) {
    a.mWindowAdded = true;
    wm.addView(decor, l);
    }
</code></pre><p>具体流程参考ActivityThread#handleResumeActivity()流程</p>
<p>涉及到window，DecroView等</p>
<h2 id="AMS-通知显示Acitivity-B已经Onresume，"><a href="#AMS-通知显示Acitivity-B已经Onresume，" class="headerlink" title="AMS 通知显示Acitivity B已经Onresume，"></a>AMS 通知显示Acitivity B已经Onresume，</h2><p>然后就是和onpause一样的流程并且回调Activity的onResume</p>
<h1 id="4-哪些是公用的，为hook做准备"><a href="#4-哪些是公用的，为hook做准备" class="headerlink" title="4. 哪些是公用的，为hook做准备"></a>4. 哪些是公用的，为hook做准备</h1>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/11/01/iOS学习笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liuycheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://github.com/liuyicheng3/learning-summary/blob/master/images/avatar.jpg?raw=true">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nico随笔">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/11/01/iOS学习笔记/" itemprop="url">
                  iOS入门
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-11-01T20:10:33+08:00">
                2015-11-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="第一课：熟悉OC语法"><a href="#第一课：熟悉OC语法" class="headerlink" title="第一课：熟悉OC语法"></a>第一课：熟悉OC语法</h1><h1 id="第二课：storyboard和-手写View"><a href="#第二课：storyboard和-手写View" class="headerlink" title="第二课：storyboard和 手写View"></a>第二课：storyboard和 手写View</h1><p>storyboard;</p>
<p>直接往上面拖放控件，然后按住ctr  把控件拖动到   @implementation，就相当于自动findview了，可以直接使用是这个控件了  </p>
<p>   @property (weak, nonatomic) IBOutlet UILabel *detailDescriptionLabel;</p>
<p>还有一种就是直接关联上点击事件<br>把控件直接拖动到这个申明方法上就可以了</p>
<pre><code>- (IBAction)showAlert:(id)sender;
</code></pre><p>这个的原理可以看看storyboard的文件内容就可以明白了，大致和android的类似</p>
<p>图片资源文件两种放法</p>
<ol>
<li><p>在Supporting  Files 同级添加一个Resources的包，里面直接放图片进去（可以只放三倍图）   </p>
<pre><code>UIImageView *imageView = [[UIImageView alloc] init];
   imageView.image = [UIImage imageNamed:@&quot;home_banner.png&quot;];    // 正常显示的图片
</code></pre></li>
<li><p>在Assets.xcaseset里面右键新建New image set，然后手动把图片拖动到右边的一倍两倍三倍的框框中去 </p>
</li>
</ol>
<p>storyboard  改成手写UI类型  </p>
<ol>
<li>第一步： </li>
</ol>
<ul>
<li>删除storyboard文件  </li>
<li>编辑Supporting Files目录下的 .plist文件,<br>删除Main storyboard  file name这一项</li>
</ul>
<ol>
<li>第二步：<br> 编辑AppDelegate</li>
</ol>
<pre><code>- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    [self.window makeKeyAndVisible];

    ViewController *__rootController = [[ViewController alloc] init];
    UINavigationController *__navCtrler = [[UINavigationController alloc] initWithRootViewController:__rootController];
    __navCtrler.navigationBarHidden = YES;
    self.window.rootViewController = __navCtrler;
  // Override point for customization after application launch.
    return YES;
}
</code></pre><p>这个相当于Application的oncreate,在这里加载Entry activity</p>
<p>在ViewController里面手动往根View里面添加控件</p>
<pre><code>- (void)viewDidLoad {
    [super viewDidLoad];

    UILabel *firstLable=[[UILabel alloc]init];
    firstLable.frame=CGRectMake(0, 0, 100, 100);
    firstLable.backgroundColor = [UIColor whiteColor]; //设置lable背景颜色为黑色

    firstLable.text=@&quot;第一级&quot;;
    firstLable.userInteractionEnabled = YES;

    [firstLable setTextColor:[UIColor greenColor]]; //设置文本字体颜色为白色

    [self.view addSubview:firstLable];
    UITapGestureRecognizer *singleTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(tapLable:)];
    [firstLable addGestureRecognizer:singleTap];

    // Do any additional setup after loading the view, typically from a nib.
}
</code></pre><p>viewDidLoad 相当于Activity的oncreate，这里我们就是手写View，然后加到根View里面去 self.view<br>    [self.view addSubview:firstLable];</p>
<h1 id="第三课：Viewcontroller-之间的跳转"><a href="#第三课：Viewcontroller-之间的跳转" class="headerlink" title="第三课：Viewcontroller  之间的跳转"></a>第三课：Viewcontroller  之间的跳转</h1><p>在ViewController从一个Viewcontroller跳到另外一个SecondViewController</p>
<pre><code>-(void) tapLable:(UILabel *)sender{
    NSLog(@&quot;进入第二级Controller&quot;);

    SecondViewController *controller = [[SecondViewController alloc] init];
    [self.navigationController pushViewController:controller animated:YES];
}
</code></pre><p>在SecondViewController也是一样的写法</p>
<p> 返回第一个VIewCOntroller的方法</p>
<pre><code>[self.navigationController popViewControllerAnimated:YES];
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/11/01/分析UI流畅度/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liuycheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://github.com/liuyicheng3/learning-summary/blob/master/images/avatar.jpg?raw=true">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nico随笔">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/11/01/分析UI流畅度/" itemprop="url">
                  Android 性能检测
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-11-01T20:10:33+08:00">
                2015-11-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="手机端："><a href="#手机端：" class="headerlink" title="手机端："></a>手机端：</h1><h2 id="开发者选项"><a href="#开发者选项" class="headerlink" title="开发者选项"></a>开发者选项</h2><ol>
<li><p>绘图》 显示布局边界</p>
</li>
<li><p>硬件加速渲染 》调试GPU过渡绘制  要打开</p>
</li>
</ol>
<ol>
<li><p>监控》启用严格模式</p>
</li>
<li><p>GPU呈现模式分析  可以对照颜色表找出耗时出在那一部分<br><img src="https://github.com/liuyicheng3/learning-summary/blob/master/images/GPU%E6%B8%B2%E6%9F%93%E6%A8%A1%E5%BC%8F.jpg?raw=true" alt="image"></p>
</li>
</ol>
<h1 id="电脑端："><a href="#电脑端：" class="headerlink" title="电脑端："></a>电脑端：</h1><ol>
<li><p>查看MemoryMonitor  ，查看页面内存波动（对于listview ）</p>
</li>
<li><p>tools》android》android  device  monistor<br>（其实它就是把android sdk中tools下面的很多功能聚合起来；  如ddms，uiautomatorviewer，monitor等功能聚合起来，但是好像没有集成hierarchyviewer的功能）</p>
</li>
<li><p>查看录制页面变化时候的cpu耗时<br>开始录制》选中进程，点击红色方框左边的按钮，然后点击红色方框里右侧的按钮录制正式开始，需要结束时，再点击右侧按钮结束，就会有结果自动生成<br><img src="https://github.com/liuyicheng3/learning-summary/blob/master/images/%E5%88%86%E6%9E%90%E8%80%97%E6%97%B6.png?raw=true" alt="image"></p>
<p>分析结果》录制实际上是一个采样的过程，可以看图中红色方框里面最耗时的几个方法，基本上可以定位到程序的问题<br><img src="https://github.com/liuyicheng3/learning-summary/blob/master/images/%E5%88%86%E6%9E%90%E8%80%97%E6%97%B6_2.png?raw=true" alt="image"></p>
</li>
<li>查看布局层次，以及每一层的绘制时间，目的是减小层次<br>入口是在：tools 下面 hierarchyviewer  查看每个层次的绘制时间（这个好像必须在模拟器上看）</li>
</ol>
<h1 id="分析卡的原因"><a href="#分析卡的原因" class="headerlink" title="分析卡的原因"></a>分析卡的原因</h1><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="http://www.cnblogs.com/krislight1105/p/5352500.html" target="_blank" rel="external">http://www.cnblogs.com/krislight1105/p/5352500.html</a><br><a href="http://blog.csdn.net/wangbaochu/article/details/50396512" target="_blank" rel="external">http://blog.csdn.net/wangbaochu/article/details/50396512</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/11/01/Xcode 和Android  studio 快捷键及设置对比/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liuycheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://github.com/liuyicheng3/learning-summary/blob/master/images/avatar.jpg?raw=true">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nico随笔">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/11/01/Xcode 和Android  studio 快捷键及设置对比/" itemprop="url">
                  AS和Xcode快捷键
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-11-01T20:10:33+08:00">
                2015-11-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/工具/" itemprop="url" rel="index">
                    <span itemprop="name">工具</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Xcode"><a href="#Xcode" class="headerlink" title="Xcode"></a>Xcode</h1><p>XCode   不能直接修改文件名，需要找到本文件对应的申明或者实现的名称，右键refactor&gt;rename  修改<br>（记得勾选 Rename related files）</p>
<p>在 Xcode里面所有的窗口控制显示与否都可以通过右上角的来控制  </p>
<p>定位类的位置  shift  commoand  j</p>
<p>commond  6 </p>
<p>option 然后点击方法位置</p>
<p>commond   T</p>
<p>shift  commoand  O</p>
<p>shift  commoand  F</p>
<p> commoand  F</p>
<p>esc  查看方法参数   </p>
<p>快捷键位置方法   XCode&gt;preferences&gt;Key Bindings</p>
<p>显示主题颜色设置   XCode&gt;preferences&gt;Font &amp; Colors   从Default  改成   Dusk<br>窗口显示和隐藏的button（其中代码下面的debug和log窗口在他们的右下角又有单独的控制显示和隐藏的button）  </p>
<p><img src="https://github.com/liuyicheng3/learning-summary/blob/master/images/Xcode%E8%AE%BE%E7%BD%AE.png?raw=true" alt="image"></p>
<p><img src="https://github.com/liuyicheng3/learning-summary/blob/master/images/Xcode%E5%BF%AB%E6%8D%B7%E9%94%AE.jpg?raw=true" alt="image">  </p>
<p>参考资料：<a href="http://www.cocoachina.com/ios/20141224/10752.html" target="_blank" rel="external">http://www.cocoachina.com/ios/20141224/10752.html</a></p>
<h1 id="AndroidStudio"><a href="#AndroidStudio" class="headerlink" title="AndroidStudio"></a>AndroidStudio</h1><p>快捷键位置方法   AndroidStudio&gt;preferences&gt;Keymap  （把Mac  OS X 复制一份，然后修改）</p>
<p>显示主题颜色设置   AndroidStudio&gt;preferences&gt;Editor&gt;Colors &amp; Font   从Default  改成   Darcula  (然后点击 save as  ，再把字体调大一点，不能直接修改) </p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>


          
          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://github.com/liuyicheng3/learning-summary/blob/master/images/avatar.jpg?raw=true"
               alt="Liuycheng" />
          <p class="site-author-name" itemprop="name">Liuycheng</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">30</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">32</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Liuycheng</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  





  



  
  

  

  

  

  


  

</body>
</html>
